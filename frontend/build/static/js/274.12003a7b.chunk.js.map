{"version":3,"file":"static/js/274.12003a7b.chunk.js","mappings":"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","sources":["views/dashboard/Avombro sub.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react'\r\nimport { Form } from 'protected-aidaforms';\r\nimport { json, useParams } from 'react-router-dom'; // import the useParams hook\r\nimport jdt from './JSON';\r\nimport UtenteDataService from \"C:/Users/ines_/fisiosys/frontend/src/services/tutorial.service.js\"\r\nimport swal from 'sweetalert';\r\nimport { replaceValuesJDT } from './SavedValues.js';\r\n\r\nconsole.log('first', jdt);\r\n\r\nconst Avombrosub = () => {\r\n\r\n  useEffect(() => {\r\n    const pageReloaded = sessionStorage.getItem('pageReloaded');\r\n    if (!pageReloaded) {\r\n      sessionStorage.setItem('pageReloaded', true);\r\n      window.location.reload();\r\n    } else {\r\n      sessionStorage.removeItem('pageReloaded');\r\n    }\r\n  }, []);\r\n\r\n  const { num_sequencial } = useParams(); // get the value of num_sequencial from the route parameter\r\n  const { idcomposition } = useParams();\r\n\r\n  const [currentUtente, setCurrentUtente] = useState({\r\n    num_sequencial,\r\n    nome_utente: '',\r\n    data_nascimento: '',\r\n    sexo: ''\r\n  });\r\n\r\n  const [initialComposition, setInitialComposition] = useState({\r\n    num_sequencial,\r\n    id_initialcomposition: ''\r\n  });\r\n\r\n  const [dtaCriada, setDtaCriada] = useState(null);\r\n  const [dtaEncerrada, setDtaEncerrada] = useState(null);\r\n  const formRef = useRef(null); // add a reference to the form component\r\n\r\n  useEffect(() => {\r\n    UtenteDataService.get(num_sequencial)\r\n      .then(response => {\r\n        setCurrentUtente(prevState => ({ ...prevState, nome_utente: response.data.nome_utente, data_nascimento: response.data.data_nascimento, sexo: response.data.sexo }));\r\n      })\r\n      .catch(error => {\r\n        console.log(error);\r\n      });\r\n  }, [num_sequencial]);\r\n\r\n  useEffect(() => {\r\n    UtenteDataService.getidAvombro(num_sequencial)\r\n      .then(response => {\r\n        setInitialComposition(prevState => ({ ...prevState, id_initialcomposition: response.data.id_initialcomposition }));\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n        swal({\r\n          title: 'Erro!',\r\n          text: 'Houve um problema ao obter o id!',\r\n          icon: 'error',\r\n        });\r\n      });\r\n  }, [num_sequencial]);\r\n\r\n  const date = new Date(currentUtente.data_nascimento);\r\n  const formattedDate = date.toLocaleDateString('pt-PT', { day: '2-digit', month: '2-digit', year: 'numeric' });\r\n\r\n\r\n  const referenceModelData = [\r\n    {\"itemName\": \"Número sequencial\",\r\n    \"item\": \"num_sequencial\",\r\n    \"value\": currentUtente.num_sequencial\r\n    },\r\n    {\"itemName\": \"Nome\",\r\n    \"item\": \"nome_utente\",\r\n    \"value\": currentUtente.nome_utente\r\n    },\r\n    {\r\n     \"itemName\": \"Data de nascimento\",\r\n     \"item\": \"data_nascimento\",\r\n     \"value\": currentUtente.data_nascimento\r\n   }\r\n    ];\r\n\r\n    const handleSubmit = (values, changedFields) => {\r\n      UtenteDataService.createform({\r\n        idjdt: 1,\r\n        num_sequencial: currentUtente.num_sequencial,\r\n        version: 1,\r\n        createdat: new Date(),\r\n        state: 0,\r\n        id_initialcomposition: initialComposition.id_initialcomposition,\r\n        composition: values,\r\n        reference_model: referenceModelData,\r\n        isCompleted: 1\r\n      })\r\n        .then(response => {\r\n          //console.log(\"Form data submitted successfully:\", response.data);\r\n          setDtaCriada(new Date());\r\n          swal(\"\", \"Formulário submetido com sucesso.\", \"success\"); // Show SweetAlert success message\r\n          window.location.href = \"http://localhost:3000/#/avombro\";\r\n        })\r\n        .catch(error => {\r\n          console.log(\"Error submitting form data:\", error);\r\n        });\r\n    };\r\n\r\nconst handleSave = (values, changedFields) => {\r\n  UtenteDataService.createform({\r\n    idjdt: 1,\r\n    num_sequencial: currentUtente.num_sequencial,\r\n    version: 1,\r\n    createdat: new Date(),\r\n    state: 0,\r\n    id_initialcomposition: initialComposition.id_initialcomposition,\r\n    composition: values,\r\n    reference_model: referenceModelData,\r\n    isCompleted: 0\r\n  })\r\n    .then(response => {\r\n      //console.log(\"Form data saved successfully:\", response.data);\r\n      setDtaCriada(new Date());\r\n      swal(\"\", \"Formulário guardado com sucesso.\", \"success\"); // Show SweetAlert success message\r\n      window.location.href = \"http://localhost:3000/#/avombro\";\r\n    })\r\n    .catch(error => {\r\n      console.log(\"Error saving form data:\", error);\r\n    });\r\n};\r\n\r\n  const [formValues, setFormValues] = useState({\r\n    idcomposition,\r\n    num_sequencial,\r\n    composition: '',\r\n    createdat:'',\r\n    isCompleted:''\r\n  });\r\n\r\n  const [newJDT, setNewJDT] = useState(jdt);\r\n\r\n  useEffect(() => {\r\n    setNewJDT(jdt);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    console.clear(); // clear console on every render \r\n    if (!formValues.composition) { // check if composition is empty or null\r\n      console.log('using original jdt');\r\n      console.log(formValues.num_sequencial);\r\n      setNewJDT(jdt); // use the original jdt template\r\n      console.log('original',jdt);\r\n      console.log('the new',newJDT);\r\n    } else {\r\n      const compositionval = JSON.parse(formValues.composition);\r\n      const newJDT = replaceValuesJDT(jdt, compositionval);\r\n      console.log('using replaced jdt', newJDT);\r\n      setNewJDT(newJDT);\r\n    }\r\n  }, [formValues.composition]);\r\n\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  \r\n  useEffect(() => {\r\n    UtenteDataService.getSubAvombro(num_sequencial)\r\n      .then(response => {\r\n        setFormValues(prevState => ({ ...prevState, num_sequencial: response.data.num_sequencial, composition: response.data.composition, createdat: response.data.createdat, isCompleted: response.data.isCompleted }));\r\n        setIsLoading(false);\r\n      })\r\n      .catch((error) => {\r\n        console.log('Novo forms');\r\n      });\r\n  }, [num_sequencial]);\r\n\r\n  const createdDate = new Date(formValues.createdat);\r\n  const formattedcreatedDate = createdDate.toLocaleString('pt-PT', {\r\n    day: '2-digit',\r\n    month: '2-digit',\r\n    year: 'numeric',\r\n    hour: '2-digit',\r\n    minute: '2-digit',\r\n    second: '2-digit'\r\n  });\r\n\r\n  const estado = formValues.isCompleted === true || formValues.isCompleted === 1 ? \"Terminado\" : \"Rascunho\";\r\n\r\n  //const novoJDT = replaceValuesJDT(jdt, compositionval);\r\n  //console.log(\"new:\", novoJDT);\r\n\r\n  //console.log(\"Valores:\", formValues.composition);\r\n  //const compositionval = JSON.parse(formValues.composition);\r\n  //const newJDT = replaceValuesJDT(jdt, compositionval);\r\n  //const newJDT = replaceValuesJDT(jdt, formValues.composition);\r\n\r\n  return ( \r\n    <>\r\n      {!isLoading && currentUtente.nome_utente !== '' && initialComposition.id_initialcomposition !== '' && newJDT !== '' && (\r\n        <Form\r\n        ref={formRef} // pass the reference to the form component\r\n        onSubmit={handleSubmit}\r\n        onSave={handleSave}\r\n        onCancel={() => {\r\n          swal(\"\", \"Cancelado com sucesso\", \"warning\"); // Show SweetAlert warning message\r\n          window.history.back(); // Go back to previous page\r\n        }}\r\n        template={newJDT}\r\n        dlm={{}}\r\n        showPrint={true}\r\n        editMode={true}\r\n        professionalTasks={[\"Registar Pedido\", \"Consultar Pedido\", \"Anular Pedido\"]}\r\n        canSubmit={true}\r\n        canSave={true}\r\n        canCancel={true}\r\n        patientData={{\r\n        \"numSequencial\": currentUtente.num_sequencial,\r\n        \"nome\": currentUtente.nome_utente,\r\n        \"dtaNascimento\": formattedDate,\r\n        \"sexo\": currentUtente.sexo,\r\n        \"processo\":  formValues.idcomposition\r\n        }}\r\n        reportData={{\r\n        estado: estado,\r\n        dtaCriada: formattedcreatedDate,\r\n        realizada: \"Inês Silva\",\r\n        responsavel: \"Inês Silva\"\r\n        }}\r\n        referenceModel={[\r\n         {\"itemName\": \"Número sequencial\",\r\n         \"item\": \"num_seq\",\r\n         \"value\": currentUtente.num_sequencial,\r\n         \"formVisible\": true\r\n         },\r\n         {\"itemName\": \"Nome\",\r\n         \"item\": \"Nome\",\r\n         \"value\": currentUtente.nome_utente,\r\n         \"formVisible\": true\r\n         },\r\n         {\r\n          \"itemName\": \"Data de nascimento\",\r\n          \"item\": \"dtaNascimento\",\r\n          \"value\": formattedDate,\r\n          \"formVisible\": true\r\n        }\r\n         ]}\r\n         submitButtonDisabled={false}\r\n         saveButtonDisabled={false}\r\n         />\r\n         )}\r\n       </>\r\n     );\r\n  \r\n};\r\n\r\nexport default Avombrosub;\r\n"],"names":["console","log","jdt","useEffect","sessionStorage","getItem","removeItem","setItem","window","location","reload","num_sequencial","useParams","idcomposition","useState","nome_utente","data_nascimento","sexo","currentUtente","setCurrentUtente","id_initialcomposition","initialComposition","setInitialComposition","setDtaCriada","formRef","useRef","UtenteDataService","then","response","prevState","data","catch","error","swal","title","text","icon","formattedDate","Date","toLocaleDateString","day","month","year","referenceModelData","composition","createdat","isCompleted","formValues","setFormValues","newJDT","setNewJDT","clear","compositionval","JSON","parse","replaceValuesJDT","isLoading","setIsLoading","formattedcreatedDate","toLocaleString","hour","minute","second","estado","ref","onSubmit","values","changedFields","idjdt","version","state","reference_model","href","onSave","onCancel","history","back","template","dlm","showPrint","editMode","professionalTasks","canSubmit","canSave","canCancel","patientData","reportData","dtaCriada","realizada","responsavel","referenceModel","submitButtonDisabled","saveButtonDisabled"],"sourceRoot":""}