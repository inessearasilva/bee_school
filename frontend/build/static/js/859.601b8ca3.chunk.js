"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[859],{1859:function(e,t,o){o.r(t);var n=o(1413),i=o(70885),a=o(72791),s=o(8761),c=o(57689),u=o(47433),m=o(15563),l=o(62062),d=o.n(l),r=o(24662),f=o(80184);console.log("first",u.Z);t.default=function(){(0,a.useEffect)((function(){sessionStorage.getItem("pageReloaded")?sessionStorage.removeItem("pageReloaded"):(sessionStorage.setItem("pageReloaded",!0),window.location.reload())}),[]);var e=(0,c.UO)().num_sequencial,t=(0,c.UO)().idcomposition,o=(0,a.useState)({num_sequencial:e,nome_utente:"",data_nascimento:"",sexo:""}),l=(0,i.Z)(o,2),p=l[0],g=l[1],_=(0,a.useState)({num_sequencial:e,id_initialcomposition:""}),v=(0,i.Z)(_,2),h=v[0],Z=v[1],S=(0,a.useState)(null),q=(0,i.Z)(S,2),w=(q[0],q[1]),b=(0,a.useState)(null),N=(0,i.Z)(b,2),C=(N[0],N[1],(0,a.useRef)(null));(0,a.useEffect)((function(){m.Z.get(e).then((function(e){g((function(t){return(0,n.Z)((0,n.Z)({},t),{},{nome_utente:e.data.nome_utente,data_nascimento:e.data.data_nascimento,sexo:e.data.sexo})}))})).catch((function(e){console.log(e)}))}),[e]),(0,a.useEffect)((function(){m.Z.getidAvini(e).then((function(e){Z((function(t){return(0,n.Z)((0,n.Z)({},t),{},{id_initialcomposition:e.data.id_initialcomposition})}))})).catch((function(e){console.log(e),d()({title:"Erro!",text:"Houve um problema ao obter o id!",icon:"error"})}))}),[e]);var D=new Date(p.data_nascimento).toLocaleDateString("pt-PT",{day:"2-digit",month:"2-digit",year:"numeric"}),E=[{itemName:"N\xfamero sequencial",item:"num_sequencial",value:p.num_sequencial},{itemName:"Nome",item:"nome_utente",value:p.nome_utente},{itemName:"Data de nascimento",item:"data_nascimento",value:p.data_nascimento}],x=(0,a.useState)({idcomposition:t,num_sequencial:e,composition:"",createdat:"",isCompleted:""}),j=(0,i.Z)(x,2),k=j[0],y=j[1],P=(0,a.useState)(u.Z),R=(0,i.Z)(P,2),I=R[0],F=R[1];(0,a.useEffect)((function(){F(u.Z)}),[]),(0,a.useEffect)((function(){if(console.clear(),k.composition){var e=JSON.parse(k.composition),t=(0,r.G)(u.Z,e);console.log("using replaced jdt",t),F(t)}else console.log("using original jdt"),console.log(k.num_sequencial),F(u.Z),console.log("original",u.Z),console.log("the new",I)}),[k.composition]);var T=(0,a.useState)(!0),A=(0,i.Z)(T,2),O=A[0],V=A[1];(0,a.useEffect)((function(){m.Z.getSubAvini(e).then((function(e){y((function(t){return(0,n.Z)((0,n.Z)({},t),{},{num_sequencial:e.data.num_sequencial,composition:e.data.composition,createdat:e.data.createdat,isCompleted:e.data.isCompleted})})),V(!1)})).catch((function(e){console.log("Novo forms")}))}),[e]);var B=new Date(k.createdat).toLocaleString("pt-PT",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),L=!0===k.isCompleted||1===k.isCompleted?"Terminado":"Rascunho";return(0,f.jsx)(f.Fragment,{children:!O&&""!==p.nome_utente&&""!==h.id_initialcomposition&&""!==I&&(0,f.jsx)(s.l,{ref:C,onSubmit:function(e,t){m.Z.createform({idjdt:0,num_sequencial:p.num_sequencial,version:1,createdat:new Date,state:0,id_initialcomposition:h.id_initialcomposition,composition:e,reference_model:E,isCompleted:1}).then((function(e){w(new Date),d()("","Formul\xe1rio submetido com sucesso.","success"),window.location.href="http://localhost:3000/#/avini"})).catch((function(e){console.log("Error submitting form data:",e)}))},onSave:function(e,t){m.Z.createform({idjdt:0,num_sequencial:p.num_sequencial,version:1,createdat:new Date,state:0,id_initialcomposition:h.id_initialcomposition,composition:e,reference_model:E,isCompleted:0}).then((function(e){console.log("Form data saved successfully:"),w(new Date),d()("","Formul\xe1rio guardado com sucesso.","success"),window.location.href="http://localhost:3000/#/avini"})).catch((function(e){console.log("Error saving form data:",e)}))},onCancel:function(){d()("","Cancelado com sucesso","warning"),window.history.back()},template:I,dlm:{},showPrint:!0,editMode:!0,professionalTasks:["Registar Pedido","Consultar Pedido","Anular Pedido"],canSubmit:!0,canSave:!0,canCancel:!0,patientData:{numSequencial:p.num_sequencial,nome:p.nome_utente,dtaNascimento:D,sexo:p.sexo,processo:k.idcomposition},reportData:{estado:L,dtaCriada:B,realizada:"In\xeas Silva",responsavel:"In\xeas Silva"},referenceModel:[{itemName:"N\xfamero sequencial",item:"num_seq",value:p.num_sequencial,formVisible:!0},{itemName:"Nome",item:"Nome",value:p.nome_utente,formVisible:!0},{itemName:"Data de nascimento",item:"dtaNascimento",value:D,formVisible:!0}],submitButtonDisabled:!1,saveButtonDisabled:!1})})}}}]);
//# sourceMappingURL=859.601b8ca3.chunk.js.map