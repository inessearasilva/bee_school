{"version":3,"file":"static/js/13.db0a1ca7.chunk.js","mappings":"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","sources":["views/dashboard/Avombro-utente.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react'\r\nimport { Form } from 'protected-aidaforms';\r\nimport { json, useParams } from 'react-router-dom'; // import the useParams hook\r\nimport jdt from './JSON';\r\nimport UtenteDataService from \"C:/Users/ines_/fisiosys/frontend/src/services/tutorial.service.js\"\r\nimport swal from 'sweetalert';\r\nimport { replaceValuesJDT } from './SavedValues.js';\r\n\r\nconsole.log('first', jdt);\r\n\r\nconst Avombronum = () => {\r\n\r\n  useEffect(() => {\r\n    const pageReloaded = sessionStorage.getItem('pageReloaded');\r\n    if (!pageReloaded) {\r\n      sessionStorage.setItem('pageReloaded', true);\r\n      window.location.reload();\r\n    } else {\r\n      sessionStorage.removeItem('pageReloaded');\r\n    }\r\n  }, []);\r\n\r\n\r\n  const { num_sequencial } = useParams(); // get the value of num_sequencial from the route parameter\r\n  const { idcomposition } = useParams();\r\n\r\n  const [currentUtente, setCurrentUtente] = useState({\r\n    num_sequencial,\r\n    nome_utente: '',\r\n    data_nascimento: '',\r\n    sexo:''\r\n  });\r\n\r\n  const [initialComposition, setInitialComposition] = useState({\r\n    num_sequencial,\r\n    id_initialcomposition: ''\r\n  });\r\n\r\n  const [dtaCriada, setDtaCriada] = useState(null);\r\n  const [dtaEncerrada, setDtaEncerrada] = useState(null);\r\n  const formRef = useRef(null); // add a reference to the form component\r\n\r\n  useEffect(() => {\r\n    UtenteDataService.get(num_sequencial)\r\n      .then(response => {\r\n        setCurrentUtente(prevState => ({ ...prevState, nome_utente: response.data.nome_utente, data_nascimento: response.data.data_nascimento, sexo: response.data.sexo }));\r\n      })\r\n      .catch(error => {\r\n        console.log(error);\r\n      });\r\n  }, [num_sequencial]);\r\n\r\n  useEffect(() => {\r\n    UtenteDataService.getidAvombro(num_sequencial)\r\n      .then(response => {\r\n        setInitialComposition(prevState => ({ ...prevState, id_initialcomposition: response.data.id_initialcomposition }));\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n        swal({\r\n          title: 'Erro!',\r\n          text: 'Houve um problema ao obter o id!',\r\n          icon: 'error',\r\n        });\r\n      });\r\n  }, [num_sequencial]);\r\n\r\n  const date = new Date(currentUtente.data_nascimento);\r\n  const formattedDate = date.toLocaleDateString('pt-PT', { day: '2-digit', month: '2-digit', year: 'numeric' });\r\n\r\n\r\n  const referenceModelData = [\r\n    {\"itemName\": \"Número sequencial\",\r\n    \"item\": \"num_sequencial\",\r\n    \"value\": currentUtente.num_sequencial\r\n    },\r\n    {\"itemName\": \"Nome\",\r\n    \"item\": \"nome_utente\",\r\n    \"value\": currentUtente.nome_utente\r\n    },\r\n    {\r\n     \"itemName\": \"Data de nascimento\",\r\n     \"item\": \"data_nascimento\",\r\n     \"value\": currentUtente.data_nascimento\r\n   }\r\n    ];\r\n\r\n    const handleSubmit = (values, changedFields) => {\r\n      UtenteDataService.createform({\r\n        idjdt: 1,\r\n        num_sequencial: currentUtente.num_sequencial,\r\n        version: 1,\r\n        createdat: new Date(),\r\n        state: 0,\r\n        id_initialcomposition: initialComposition.id_initialcomposition,\r\n        composition: values,\r\n        reference_model: referenceModelData,\r\n        isCompleted: 1\r\n      })\r\n        .then(response => {\r\n          //console.log(\"Form data submitted successfully:\", response.data);\r\n          setDtaCriada(new Date());\r\n          swal(\"\", \"Formulário submetido com sucesso.\", \"success\"); // Show SweetAlert success message\r\n          window.location.href = \"http://localhost:3000/#/avombro\";\r\n        })\r\n        .catch(error => {\r\n          console.log(\"Error submitting form data:\", error);\r\n        });\r\n    };\r\n\r\nconst handleSave = (values, changedFields) => {\r\n  UtenteDataService.createform({\r\n    idjdt: 1,\r\n    num_sequencial: currentUtente.num_sequencial,\r\n    version: 1,\r\n    createdat: new Date(),\r\n    state: 0,\r\n    id_initialcomposition: initialComposition.id_initialcomposition,\r\n    composition: values,\r\n    reference_model: referenceModelData,\r\n    isCompleted: 0\r\n  })\r\n    .then(response => {\r\n      //console.log(\"Form data saved successfully:\", response.data);\r\n      setDtaCriada(new Date());\r\n      swal(\"\", \"Formulário guardado com sucesso.\", \"success\"); // Show SweetAlert success message\r\n      window.location.href = \"http://localhost:3000/#/avombro\";\r\n    })\r\n    .catch(error => {\r\n      console.log(\"Error saving form data:\", error);\r\n    });\r\n};\r\n\r\n  const [formValues, setFormValues] = useState({\r\n    num_sequencial,\r\n    composition: ''\r\n  });\r\n\r\n  const [newJDT, setNewJDT] = useState(jdt);\r\n\r\n  useEffect(() => {\r\n    setNewJDT(jdt);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    console.clear(); // clear console on every render \r\n    if (!formValues.composition) { // check if composition is empty or null\r\n      console.log('using original jdt');\r\n      console.log(formValues.num_sequencial);\r\n      setNewJDT(jdt); // use the original jdt template\r\n      console.log('original',jdt);\r\n      console.log('the new',newJDT);\r\n    } else {\r\n      const compositionval = JSON.parse(formValues.composition);\r\n      const newJDT = replaceValuesJDT(jdt, compositionval);\r\n      console.log('using replaced jdt', newJDT);\r\n      setNewJDT(newJDT);\r\n    }\r\n  }, [formValues.composition]);\r\n  \r\n  const [isLoading, setIsLoading] = useState(true);\r\n  \r\n  useEffect(() => {\r\n    UtenteDataService.getvaluesAvombro(num_sequencial)\r\n      .then(response => {\r\n        setFormValues(prevState => ({ ...prevState, num_sequencial: response.data.num_sequencial, composition: response.data.composition }));\r\n        setIsLoading(false);\r\n      })\r\n      .catch((error) => {\r\n        console.log('Novo forms');\r\n      });\r\n  }, [num_sequencial]);\r\n\r\n\r\n  //const novoJDT = replaceValuesJDT(jdt, compositionval);\r\n  //console.log(\"new:\", novoJDT);\r\n\r\n  //console.log(\"Valores:\", formValues.composition);\r\n  //const compositionval = JSON.parse(formValues.composition);\r\n  //const newJDT = replaceValuesJDT(jdt, compositionval);\r\n  //const newJDT = replaceValuesJDT(jdt, formValues.composition);\r\n\r\n  return ( \r\n    <>\r\n      {!isLoading && currentUtente.nome_utente !== '' && initialComposition.id_initialcomposition !== '' && newJDT !== '' && (\r\n        <Form\r\n        ref={formRef} // pass the reference to the form component\r\n        onSubmit={handleSubmit}\r\n        onSave={handleSave}\r\n        onCancel={() => {\r\n          swal(\"\", \"Cancelado com sucesso\", \"warning\"); // Show SweetAlert warning message\r\n          window.history.back(); // Go back to previous page\r\n        }}\r\n        template={newJDT}\r\n        dlm={{}}\r\n        showPrint={false}\r\n        editMode={true}\r\n        professionalTasks={[\"Registar Pedido\", \"Consultar Pedido\", \"Anular Pedido\"]}\r\n        canSubmit={true}\r\n        canSave={true}\r\n        canCancel={true}\r\n        patientData={{\r\n        \"numSequencial\": currentUtente.num_sequencial,\r\n        \"nome\": currentUtente.nome_utente,\r\n        \"dtaNascimento\": currentUtente.data_nascimento,\r\n        \"sexo\": currentUtente.sexo,\r\n        \"episodio\":  initialComposition.id_initialcomposition\r\n        }}\r\n        reportData={{\r\n        dtaEncerrada: dtaEncerrada ? dtaEncerrada.toLocaleString() : null,\r\n        dtaCriada: dtaCriada ? dtaCriada.toLocaleString() : null,\r\n        realizada: \"Inês Silva\",\r\n        responsavel: \"Inês Silva\"\r\n        }}\r\n        referenceModel={[\r\n         {\"itemName\": \"Número sequencial\",\r\n         \"item\": \"num_seq\",\r\n         \"value\": currentUtente.num_sequencial,\r\n         \"formVisible\": true\r\n         },\r\n         {\"itemName\": \"Nome\",\r\n         \"item\": \"Nome\",\r\n         \"value\": currentUtente.nome_utente,\r\n         \"formVisible\": true\r\n         },\r\n         {\r\n          \"itemName\": \"Data de nascimento\",\r\n          \"item\": \"dtaNascimento\",\r\n          \"value\": formattedDate,\r\n          \"formVisible\": true\r\n        }\r\n         ]}\r\n         submitButtonDisabled={false}\r\n         saveButtonDisabled={false}\r\n         />\r\n         )}\r\n       </>\r\n     );\r\n  \r\n};\r\n\r\nexport default Avombronum;\r\n"],"names":["console","log","jdt","useEffect","sessionStorage","getItem","removeItem","setItem","window","location","reload","num_sequencial","useParams","idcomposition","useState","nome_utente","data_nascimento","sexo","currentUtente","setCurrentUtente","id_initialcomposition","initialComposition","setInitialComposition","dtaCriada","setDtaCriada","dtaEncerrada","formRef","useRef","UtenteDataService","then","response","prevState","data","catch","error","swal","title","text","icon","formattedDate","Date","toLocaleDateString","day","month","year","referenceModelData","composition","formValues","setFormValues","newJDT","setNewJDT","clear","compositionval","JSON","parse","replaceValuesJDT","isLoading","setIsLoading","ref","onSubmit","values","changedFields","idjdt","version","createdat","state","reference_model","isCompleted","href","onSave","onCancel","history","back","template","dlm","showPrint","editMode","professionalTasks","canSubmit","canSave","canCancel","patientData","reportData","toLocaleString","realizada","responsavel","referenceModel","submitButtonDisabled","saveButtonDisabled"],"sourceRoot":""}