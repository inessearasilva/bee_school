{"ast":null,"code":"import React, { useContext, useEffect, useState } from \"react\";\nimport SidePanel from \"../SidePanel\";\nimport CombinedContext from \"../../../../../contexts/CombinedContext\";\nimport DraggableItemsList from \"../../../UI/DraggableItems/DraggableItemsList\";\nimport Accordion from \"../../../UI/Accordion/Accordion\";\nimport Dropdown from \"../../../UI/DropdownWithoutContainer/Dropdown\";\nimport DraggableItem from \"../../../UI/DraggableItems/DraggableItem\";\nimport axios from \"axios\";\nimport { getEnvUrl } from \"../../../../../environment\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faExclamationCircle } from \"@fortawesome/free-solid-svg-icons\";\nconst ReferenceModelPanel = props => {\n  const context = useContext(CombinedContext);\n  const [rmComponents, setRmComponents] = useState([]);\n  const [currentItemPath, setCurrentItemPath] = useState(\"\");\n  useEffect(() => {\n    //VER SE O PATH ACTUAL ESTÁ ASSOCIADO A UM COMPONENTE DO REFERENCE MODEL\n    if (context.rmData.rmJDT !== null) {\n      let type = [];\n      for (const i of Object.keys(context.rmData.rmJDT)) {\n        if (context.composition.openCompositionPlanningPath === i) {\n          type.push(context.rmData.rmJDT[i].rm_type);\n        } else if (i === \"\" && context.composition.openCompositionPlanningPath === \"root\") {\n          type.push(context.rmData.rmJDT[i].rm_type);\n        }\n      }\n      (async () => {\n        axios({\n          method: \"post\",\n          url: `${getEnvUrl('aidaforms', '4011')}/getRM`,\n          headers: {\n            'Content-Type': 'application/json',\n            Authorization: \"Bearer \" + context.token\n          },\n          data: {\n            rm_type: type\n          }\n        }).then(res => {\n          if (res.data.success === true) {\n            setRmComponents(res.data.data);\n            setCurrentItemPath(context.composition.openCompositionPlanningPath);\n          }\n        });\n      })();\n    }\n  }, [context.composition.openCompositionPlanningPath]);\n  let accordionData = [];\n  let accordionData2 = [];\n  let accordionData3 = [];\n  let dataList;\n  let contentData;\n  let content;\n  content = /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-full py-4 px-3\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex w-full items-center m-1 py-1 px-2 rounded-sm text-red-500 bg-gray-100 border\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"pr-2\"\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    size: \"sm\",\n    icon: faExclamationCircle\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"text-sm max-w-full flex-initial cursor-default\"\n  }, \"Dados inexistentes\")));\n  if (rmComponents !== undefined) {\n    rmComponents.forEach(item => {\n      if (item.data !== null) {\n        item.data.forEach(it => {\n          if (it.items) {\n            //tem items do 2º nível - significa que pode ter draggableItems ou mais níveis de hierarquia\n            dataList = it.items;\n            it.items.forEach(i => {\n              //tem items do 3º nível\n              if (i.items) {\n                accordionData3.push({\n                  title: i.itemName,\n                  content: /*#__PURE__*/React.createElement(DraggableItemsList, {\n                    data: i.items,\n                    path: currentItemPath\n                  })\n                }); // se tem items significa que não pode ser um draggableItem então tem que ser um nested accordion\n\n                contentData = /*#__PURE__*/React.createElement(Dropdown, {\n                  dropData: accordionData3\n                }); // o item tem que ser removido da lista de draggableItems\n\n                dataList = dataList.filter(el => el !== i);\n              }\n            });\n            accordionData2.push({\n              title: it.itemName,\n              content: contentData ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(DraggableItemsList, {\n                data: dataList,\n                path: currentItemPath\n              }), contentData) : /*#__PURE__*/React.createElement(DraggableItemsList, {\n                data: dataList,\n                path: currentItemPath\n              })\n            });\n          } //não tem items do 2º nível - significa que é um draggableItem\n          else {\n            accordionData2.push({\n              title: it.itemName,\n              content: /*#__PURE__*/React.createElement(DraggableItem, {\n                handleRM: context.rmData.handleAddRM,\n                data: it,\n                isRM: true,\n                path: it.itemPath,\n                pathRM: currentItemPath\n              })\n            });\n          }\n        });\n        accordionData.push({\n          title: item.rm_type,\n          content: /*#__PURE__*/React.createElement(Dropdown, {\n            dropData: accordionData2\n          })\n        });\n        accordionData2 = [];\n        content = /*#__PURE__*/React.createElement(Accordion, {\n          accordionData: accordionData\n        });\n      }\n    });\n  }\n  return /*#__PURE__*/React.createElement(SidePanel, {\n    title: \"Componentes do Reference Model\",\n    content: content,\n    isSidePanelOpen: props.isSidePanelOpen,\n    collapseSidePanel: () => props.collapseSidePanel(),\n    onCancelChanges: () => this.handleCancelChanges(),\n    onClosed: () => this.handleConfirmChanges()\n  });\n};\nexport default ReferenceModelPanel;","map":{"version":3,"names":["React","useContext","useEffect","useState","SidePanel","CombinedContext","DraggableItemsList","Accordion","Dropdown","DraggableItem","axios","getEnvUrl","FontAwesomeIcon","faExclamationCircle","ReferenceModelPanel","props","context","rmComponents","setRmComponents","currentItemPath","setCurrentItemPath","rmData","rmJDT","type","i","Object","keys","composition","openCompositionPlanningPath","push","rm_type","method","url","headers","Authorization","token","data","then","res","success","accordionData","accordionData2","accordionData3","dataList","contentData","content","createElement","className","size","icon","undefined","forEach","item","it","items","title","itemName","path","dropData","filter","el","Fragment","handleRM","handleAddRM","isRM","itemPath","pathRM","isSidePanelOpen","collapseSidePanel","onCancelChanges","handleCancelChanges","onClosed","handleConfirmChanges"],"sources":["C:/Users/ines_/fisiosys/frontend/node_modules/protected-aidaforms/dist/components/FormDesigner/Sidebar/SidePanel/ReferenceModelPanel/ReferenceModelPanel.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\r\nimport SidePanel from \"../SidePanel\";\r\nimport CombinedContext from \"../../../../../contexts/CombinedContext\";\r\nimport DraggableItemsList from \"../../../UI/DraggableItems/DraggableItemsList\";\r\nimport Accordion from \"../../../UI/Accordion/Accordion\";\r\nimport Dropdown from \"../../../UI/DropdownWithoutContainer/Dropdown\";\r\nimport DraggableItem from \"../../../UI/DraggableItems/DraggableItem\";\r\nimport axios from \"axios\";\r\nimport { getEnvUrl } from \"../../../../../environment\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faExclamationCircle } from \"@fortawesome/free-solid-svg-icons\";\r\n\r\nconst ReferenceModelPanel = props => {\r\n  const context = useContext(CombinedContext);\r\n  const [rmComponents, setRmComponents] = useState([]);\r\n  const [currentItemPath, setCurrentItemPath] = useState(\"\");\r\n  useEffect(() => {\r\n    //VER SE O PATH ACTUAL ESTÁ ASSOCIADO A UM COMPONENTE DO REFERENCE MODEL\r\n    if (context.rmData.rmJDT !== null) {\r\n      let type = [];\r\n\r\n      for (const i of Object.keys(context.rmData.rmJDT)) {\r\n        if (context.composition.openCompositionPlanningPath === i) {\r\n          type.push(context.rmData.rmJDT[i].rm_type);\r\n        } else if (i === \"\" && context.composition.openCompositionPlanningPath === \"root\") {\r\n          type.push(context.rmData.rmJDT[i].rm_type);\r\n        }\r\n      }\r\n\r\n      (async () => {\r\n        axios({\r\n          method: \"post\",\r\n          url: `${getEnvUrl('aidaforms', '4011')}/getRM`,\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            Authorization: \"Bearer \" + context.token\r\n          },\r\n          data: {\r\n            rm_type: type\r\n          }\r\n        }).then(res => {\r\n          if (res.data.success === true) {\r\n            setRmComponents(res.data.data);\r\n            setCurrentItemPath(context.composition.openCompositionPlanningPath);\r\n          }\r\n        });\r\n      })();\r\n    }\r\n  }, [context.composition.openCompositionPlanningPath]);\r\n  let accordionData = [];\r\n  let accordionData2 = [];\r\n  let accordionData3 = [];\r\n  let dataList;\r\n  let contentData;\r\n  let content;\r\n  content = /*#__PURE__*/React.createElement(\"div\", {\r\n    className: \"w-full py-4 px-3\"\r\n  }, /*#__PURE__*/React.createElement(\"div\", {\r\n    className: \"flex w-full items-center m-1 py-1 px-2 rounded-sm text-red-500 bg-gray-100 border\"\r\n  }, /*#__PURE__*/React.createElement(\"div\", {\r\n    className: \"pr-2\"\r\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\r\n    size: \"sm\",\r\n    icon: faExclamationCircle\r\n  })), /*#__PURE__*/React.createElement(\"div\", {\r\n    className: \"text-sm max-w-full flex-initial cursor-default\"\r\n  }, \"Dados inexistentes\")));\r\n\r\n  if (rmComponents !== undefined) {\r\n    rmComponents.forEach(item => {\r\n      if (item.data !== null) {\r\n        item.data.forEach(it => {\r\n          if (it.items) {\r\n            //tem items do 2º nível - significa que pode ter draggableItems ou mais níveis de hierarquia\r\n            dataList = it.items;\r\n            it.items.forEach(i => {\r\n              //tem items do 3º nível\r\n              if (i.items) {\r\n                accordionData3.push({\r\n                  title: i.itemName,\r\n                  content: /*#__PURE__*/React.createElement(DraggableItemsList, {\r\n                    data: i.items,\r\n                    path: currentItemPath\r\n                  })\r\n                }); // se tem items significa que não pode ser um draggableItem então tem que ser um nested accordion\r\n\r\n                contentData = /*#__PURE__*/React.createElement(Dropdown, {\r\n                  dropData: accordionData3\r\n                }); // o item tem que ser removido da lista de draggableItems\r\n\r\n                dataList = dataList.filter(el => el !== i);\r\n              }\r\n            });\r\n            accordionData2.push({\r\n              title: it.itemName,\r\n              content: contentData ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(DraggableItemsList, {\r\n                data: dataList,\r\n                path: currentItemPath\r\n              }), contentData) : /*#__PURE__*/React.createElement(DraggableItemsList, {\r\n                data: dataList,\r\n                path: currentItemPath\r\n              })\r\n            });\r\n          } //não tem items do 2º nível - significa que é um draggableItem\r\n          else {\r\n              accordionData2.push({\r\n                title: it.itemName,\r\n                content: /*#__PURE__*/React.createElement(DraggableItem, {\r\n                  handleRM: context.rmData.handleAddRM,\r\n                  data: it,\r\n                  isRM: true,\r\n                  path: it.itemPath,\r\n                  pathRM: currentItemPath\r\n                })\r\n              });\r\n            }\r\n        });\r\n        accordionData.push({\r\n          title: item.rm_type,\r\n          content: /*#__PURE__*/React.createElement(Dropdown, {\r\n            dropData: accordionData2\r\n          })\r\n        });\r\n        accordionData2 = [];\r\n        content = /*#__PURE__*/React.createElement(Accordion, {\r\n          accordionData: accordionData\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  return /*#__PURE__*/React.createElement(SidePanel, {\r\n    title: \"Componentes do Reference Model\",\r\n    content: content,\r\n    isSidePanelOpen: props.isSidePanelOpen,\r\n    collapseSidePanel: () => props.collapseSidePanel(),\r\n    onCancelChanges: () => this.handleCancelChanges(),\r\n    onClosed: () => this.handleConfirmChanges()\r\n  });\r\n};\r\n\r\nexport default ReferenceModelPanel;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}