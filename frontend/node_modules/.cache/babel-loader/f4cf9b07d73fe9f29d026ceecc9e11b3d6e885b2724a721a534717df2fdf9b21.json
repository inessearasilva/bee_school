{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function () {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getPreviewFromContent = exports.getLinkPreview = void 0;\nvar cheerio_1 = __importDefault(require(\"cheerio\"));\nvar cross_fetch_1 = require(\"cross-fetch\");\nvar abort_controller_1 = __importDefault(require(\"abort-controller\"));\nvar url_1 = __importDefault(require(\"url\"));\nvar constants_1 = require(\"./constants\");\nfunction throwOnLoopback(address) {\n  if (constants_1.CONSTANTS.REGEX_LOOPBACK.test(address)) {\n    throw new Error(\"SSRF request detected, trying to query host\");\n  }\n}\nfunction metaTag(doc, type, attr) {\n  var nodes = doc(\"meta[\".concat(attr, \"='\").concat(type, \"']\"));\n  return nodes.length ? nodes : null;\n}\nfunction metaTagContent(doc, type, attr) {\n  return doc(\"meta[\".concat(attr, \"='\").concat(type, \"']\")).attr(\"content\");\n}\nfunction getTitle(doc) {\n  var title = metaTagContent(doc, \"og:title\", \"property\") || metaTagContent(doc, \"og:title\", \"name\");\n  if (!title) {\n    title = doc(\"title\").text();\n  }\n  return title;\n}\nfunction getSiteName(doc) {\n  var siteName = metaTagContent(doc, \"og:site_name\", \"property\") || metaTagContent(doc, \"og:site_name\", \"name\");\n  return siteName;\n}\nfunction getDescription(doc) {\n  var description = metaTagContent(doc, \"description\", \"name\") || metaTagContent(doc, \"Description\", \"name\") || metaTagContent(doc, \"og:description\", \"property\");\n  return description;\n}\nfunction getMediaType(doc) {\n  var node = metaTag(doc, \"medium\", \"name\");\n  if (node) {\n    var content = node.attr(\"content\");\n    return content === \"image\" ? \"photo\" : content;\n  }\n  return metaTagContent(doc, \"og:type\", \"property\") || metaTagContent(doc, \"og:type\", \"name\");\n}\nfunction getImages(doc, rootUrl, imagesPropertyType) {\n  var images = [];\n  var nodes;\n  var src;\n  var dic = {};\n  var imagePropertyType = imagesPropertyType !== null && imagesPropertyType !== void 0 ? imagesPropertyType : \"og\";\n  nodes = metaTag(doc, \"\".concat(imagePropertyType, \":image\"), \"property\") || metaTag(doc, \"\".concat(imagePropertyType, \":image\"), \"name\");\n  if (nodes) {\n    nodes.each(function (_, node) {\n      if (node.type === \"tag\") {\n        src = node.attribs.content;\n        if (src) {\n          src = url_1.default.resolve(rootUrl, src);\n          images.push(src);\n        }\n      }\n    });\n  }\n  if (images.length <= 0 && !imagesPropertyType) {\n    src = doc(\"link[rel=image_src]\").attr(\"href\");\n    if (src) {\n      src = url_1.default.resolve(rootUrl, src);\n      images = [src];\n    } else {\n      nodes = doc(\"img\");\n      if (nodes === null || nodes === void 0 ? void 0 : nodes.length) {\n        dic = {};\n        images = [];\n        nodes.each(function (_, node) {\n          if (node.type === \"tag\") src = node.attribs.src;\n          if (src && !dic[src]) {\n            dic[src] = true;\n            // width = node.attribs.width;\n            // height = node.attribs.height;\n            images.push(url_1.default.resolve(rootUrl, src));\n          }\n        });\n      }\n    }\n  }\n  return images;\n}\nfunction getVideos(doc) {\n  var videos = [];\n  var nodeTypes;\n  var nodeSecureUrls;\n  var nodeType;\n  var nodeSecureUrl;\n  var video;\n  var videoType;\n  var videoSecureUrl;\n  var width;\n  var height;\n  var videoObj;\n  var index;\n  var nodes = metaTag(doc, \"og:video\", \"property\") || metaTag(doc, \"og:video\", \"name\");\n  if (nodes === null || nodes === void 0 ? void 0 : nodes.length) {\n    nodeTypes = metaTag(doc, \"og:video:type\", \"property\") || metaTag(doc, \"og:video:type\", \"name\");\n    nodeSecureUrls = metaTag(doc, \"og:video:secure_url\", \"property\") || metaTag(doc, \"og:video:secure_url\", \"name\");\n    width = metaTagContent(doc, \"og:video:width\", \"property\") || metaTagContent(doc, \"og:video:width\", \"name\");\n    height = metaTagContent(doc, \"og:video:height\", \"property\") || metaTagContent(doc, \"og:video:height\", \"name\");\n    for (index = 0; index < nodes.length; index += 1) {\n      var node = nodes[index];\n      if (node.type === \"tag\") video = node.attribs.content;\n      nodeType = nodeTypes === null || nodeTypes === void 0 ? void 0 : nodeTypes[index];\n      if ((nodeType === null || nodeType === void 0 ? void 0 : nodeType.type) === \"tag\") {\n        videoType = nodeType ? nodeType.attribs.content : null;\n      }\n      nodeSecureUrl = nodeSecureUrls === null || nodeSecureUrls === void 0 ? void 0 : nodeSecureUrls[index];\n      if ((nodeSecureUrl === null || nodeSecureUrl === void 0 ? void 0 : nodeSecureUrl.type) === \"tag\") {\n        videoSecureUrl = nodeSecureUrl ? nodeSecureUrl.attribs.content : null;\n      }\n      videoObj = {\n        url: video,\n        secureUrl: videoSecureUrl,\n        type: videoType,\n        width: width,\n        height: height\n      };\n      if (videoType && videoType.indexOf(\"video/\") === 0) {\n        videos.splice(0, 0, videoObj);\n      } else {\n        videos.push(videoObj);\n      }\n    }\n  }\n  return videos;\n}\n// returns default favicon (//hostname/favicon.ico) for a url\nfunction getDefaultFavicon(rootUrl) {\n  return url_1.default.resolve(rootUrl, \"/favicon.ico\");\n}\n// returns an array of URLs to favicon images\nfunction getFavicons(doc, rootUrl) {\n  var images = [];\n  var nodes = [];\n  var src;\n  var relSelectors = [\"rel=icon\", \"rel=\\\"shortcut icon\\\"\", \"rel=apple-touch-icon\"];\n  relSelectors.forEach(function (relSelector) {\n    // look for all icon tags\n    nodes = doc(\"link[\".concat(relSelector, \"]\"));\n    // collect all images from icon tags\n    if (nodes.length) {\n      nodes.each(function (_, node) {\n        if (node.type === \"tag\") src = node.attribs.href;\n        if (src) {\n          src = url_1.default.resolve(rootUrl, src);\n          images.push(src);\n        }\n      });\n    }\n  });\n  // if no icon images, use default favicon location\n  if (images.length <= 0) {\n    images.push(getDefaultFavicon(rootUrl));\n  }\n  return images;\n}\nfunction parseImageResponse(url, contentType) {\n  return {\n    url: url,\n    mediaType: \"image\",\n    contentType: contentType,\n    favicons: [getDefaultFavicon(url)]\n  };\n}\nfunction parseAudioResponse(url, contentType) {\n  return {\n    url: url,\n    mediaType: \"audio\",\n    contentType: contentType,\n    favicons: [getDefaultFavicon(url)]\n  };\n}\nfunction parseVideoResponse(url, contentType) {\n  return {\n    url: url,\n    mediaType: \"video\",\n    contentType: contentType,\n    favicons: [getDefaultFavicon(url)]\n  };\n}\nfunction parseApplicationResponse(url, contentType) {\n  return {\n    url: url,\n    mediaType: \"application\",\n    contentType: contentType,\n    favicons: [getDefaultFavicon(url)]\n  };\n}\nfunction parseTextResponse(body, url, options, contentType) {\n  if (options === void 0) {\n    options = {};\n  }\n  var doc = cheerio_1.default.load(body);\n  return {\n    url: url,\n    title: getTitle(doc),\n    siteName: getSiteName(doc),\n    description: getDescription(doc),\n    mediaType: getMediaType(doc) || \"website\",\n    contentType: contentType,\n    images: getImages(doc, url, options.imagesPropertyType),\n    videos: getVideos(doc),\n    favicons: getFavicons(doc, url)\n  };\n}\nfunction parseUnknownResponse(body, url, options, contentType) {\n  if (options === void 0) {\n    options = {};\n  }\n  return parseTextResponse(body, url, options, contentType);\n}\nfunction parseResponse(response, options) {\n  try {\n    var contentType = response.headers[\"content-type\"];\n    // console.warn(`original content type`, contentType);\n    if (contentType === null || contentType === void 0 ? void 0 : contentType.indexOf(\";\")) {\n      // eslint-disable-next-line prefer-destructuring\n      contentType = contentType.split(\";\")[0];\n      // console.warn(`splitting content type`, contentType);\n    }\n\n    if (!contentType) {\n      return parseUnknownResponse(response.data, response.url, options);\n    }\n    if (contentType instanceof Array) {\n      // eslint-disable-next-line no-param-reassign, prefer-destructuring\n      contentType = contentType[0];\n    }\n    // parse response depending on content type\n    if (constants_1.CONSTANTS.REGEX_CONTENT_TYPE_IMAGE.test(contentType)) {\n      return parseImageResponse(response.url, contentType);\n    }\n    if (constants_1.CONSTANTS.REGEX_CONTENT_TYPE_AUDIO.test(contentType)) {\n      return parseAudioResponse(response.url, contentType);\n    }\n    if (constants_1.CONSTANTS.REGEX_CONTENT_TYPE_VIDEO.test(contentType)) {\n      return parseVideoResponse(response.url, contentType);\n    }\n    if (constants_1.CONSTANTS.REGEX_CONTENT_TYPE_TEXT.test(contentType)) {\n      var htmlString_1 = response.data;\n      return parseTextResponse(htmlString_1, response.url, options, contentType);\n    }\n    if (constants_1.CONSTANTS.REGEX_CONTENT_TYPE_APPLICATION.test(contentType)) {\n      return parseApplicationResponse(response.url, contentType);\n    }\n    var htmlString = response.data;\n    return parseUnknownResponse(htmlString, response.url, options);\n  } catch (e) {\n    throw new Error(\"link-preview-js could not fetch link information \".concat(e.toString()));\n  }\n}\n/**\n * Parses the text, extracts the first link it finds and does a HTTP request\n * to fetch the website content, afterwards it tries to parse the internal HTML\n * and extract the information via meta tags\n * @param text string, text to be parsed\n * @param options ILinkPreviewOptions\n */\nfunction getLinkPreview(text, options) {\n  var _a, _b, _c;\n  return __awaiter(this, void 0, void 0, function () {\n    var detectedUrl, resolvedUrl, timeout, controller, timeoutCounter, fetchOptions, fetchUrl, response, forwardedUrl, resolvedUrl, headers, normalizedResponse;\n    var _d;\n    return __generator(this, function (_e) {\n      switch (_e.label) {\n        case 0:\n          if (!text || typeof text !== \"string\") {\n            throw new Error(\"link-preview-js did not receive a valid url or text\");\n          }\n          detectedUrl = text.replace(/\\n/g, \" \").split(\" \").find(function (token) {\n            return constants_1.CONSTANTS.REGEX_VALID_URL.test(token);\n          });\n          if (!detectedUrl) {\n            throw new Error(\"link-preview-js did not receive a valid a url or text\");\n          }\n          if ((options === null || options === void 0 ? void 0 : options.followRedirects) === \"manual\" && !(options === null || options === void 0 ? void 0 : options.handleRedirects)) {\n            throw new Error(\"link-preview-js followRedirects is set to manual, but no handleRedirects function was provided\");\n          }\n          if (!!!(options === null || options === void 0 ? void 0 : options.resolveDNSHost)) return [3 /*break*/, 2];\n          return [4 /*yield*/, options.resolveDNSHost(detectedUrl)];\n        case 1:\n          resolvedUrl = _e.sent();\n          throwOnLoopback(resolvedUrl);\n          _e.label = 2;\n        case 2:\n          timeout = (_a = options === null || options === void 0 ? void 0 : options.timeout) !== null && _a !== void 0 ? _a : 3000;\n          controller = new abort_controller_1.default();\n          timeoutCounter = setTimeout(function () {\n            return controller.abort();\n          }, timeout);\n          fetchOptions = {\n            headers: (_b = options === null || options === void 0 ? void 0 : options.headers) !== null && _b !== void 0 ? _b : {},\n            redirect: (_c = options === null || options === void 0 ? void 0 : options.followRedirects) !== null && _c !== void 0 ? _c : \"error\",\n            signal: controller.signal\n          };\n          fetchUrl = (options === null || options === void 0 ? void 0 : options.proxyUrl) ? options.proxyUrl.concat(detectedUrl) : detectedUrl;\n          return [4 /*yield*/, (0, cross_fetch_1.fetch)(fetchUrl, fetchOptions).catch(function (e) {\n            if (e.name === \"AbortError\") {\n              throw new Error(\"Request timeout\");\n            }\n            clearTimeout(timeoutCounter);\n            throw e;\n          })];\n        case 3:\n          response = _e.sent();\n          if (!(response.status > 300 && response.status < 309 && fetchOptions.redirect === \"manual\" && (options === null || options === void 0 ? void 0 : options.handleRedirects))) return [3 /*break*/, 7];\n          forwardedUrl = response.headers.get(\"location\") || \"\";\n          if (!options.handleRedirects(fetchUrl, forwardedUrl)) {\n            throw new Error(\"link-preview-js could not handle redirect\");\n          }\n          if (!!!(options === null || options === void 0 ? void 0 : options.resolveDNSHost)) return [3 /*break*/, 5];\n          return [4 /*yield*/, options.resolveDNSHost(forwardedUrl)];\n        case 4:\n          resolvedUrl = _e.sent();\n          throwOnLoopback(resolvedUrl);\n          _e.label = 5;\n        case 5:\n          return [4 /*yield*/, (0, cross_fetch_1.fetch)(forwardedUrl, fetchOptions)];\n        case 6:\n          response = _e.sent();\n          _e.label = 7;\n        case 7:\n          clearTimeout(timeoutCounter);\n          headers = {};\n          response.headers.forEach(function (header, key) {\n            headers[key] = header;\n          });\n          _d = {\n            url: (options === null || options === void 0 ? void 0 : options.proxyUrl) ? response.url.replace(options.proxyUrl, \"\") : response.url,\n            headers: headers\n          };\n          return [4 /*yield*/, response.text()];\n        case 8:\n          normalizedResponse = (_d.data = _e.sent(), _d);\n          return [2 /*return*/, parseResponse(normalizedResponse, options)];\n      }\n    });\n  });\n}\nexports.getLinkPreview = getLinkPreview;\n/**\n * Skip the library fetching the website for you, instead pass a response object\n * from whatever source you get and use the internal parsing of the HTML to return\n * the necessary information\n * @param response Preview Response\n * @param options IPreviewLinkOptions\n */\nfunction getPreviewFromContent(response, options) {\n  return __awaiter(this, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n      if (!response || typeof response !== \"object\") {\n        throw new Error(\"link-preview-js did not receive a valid response object\");\n      }\n      if (!response.url) {\n        throw new Error(\"link-preview-js did not receive a valid response object\");\n      }\n      return [2 /*return*/, parseResponse(response, options)];\n    });\n  });\n}\nexports.getPreviewFromContent = getPreviewFromContent;","map":{"version":3,"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__generator","body","_","label","sent","t","trys","ops","f","y","g","verb","Symbol","iterator","n","v","op","TypeError","call","pop","length","push","__importDefault","mod","__esModule","Object","defineProperty","exports","getPreviewFromContent","getLinkPreview","cheerio_1","require","cross_fetch_1","abort_controller_1","url_1","constants_1","throwOnLoopback","address","CONSTANTS","REGEX_LOOPBACK","test","Error","metaTag","doc","type","attr","nodes","concat","metaTagContent","getTitle","title","text","getSiteName","siteName","getDescription","description","getMediaType","node","content","getImages","rootUrl","imagesPropertyType","images","src","dic","imagePropertyType","each","attribs","default","getVideos","videos","nodeTypes","nodeSecureUrls","nodeType","nodeSecureUrl","video","videoType","videoSecureUrl","width","height","videoObj","index","url","secureUrl","indexOf","splice","getDefaultFavicon","getFavicons","relSelectors","forEach","relSelector","href","parseImageResponse","contentType","mediaType","favicons","parseAudioResponse","parseVideoResponse","parseApplicationResponse","parseTextResponse","options","load","parseUnknownResponse","parseResponse","response","headers","split","data","Array","REGEX_CONTENT_TYPE_IMAGE","REGEX_CONTENT_TYPE_AUDIO","REGEX_CONTENT_TYPE_VIDEO","REGEX_CONTENT_TYPE_TEXT","htmlString_1","REGEX_CONTENT_TYPE_APPLICATION","htmlString","toString","_a","_b","_c","detectedUrl","resolvedUrl","timeout","controller","timeoutCounter","fetchOptions","fetchUrl","forwardedUrl","normalizedResponse","_d","_e","replace","find","token","REGEX_VALID_URL","followRedirects","handleRedirects","resolveDNSHost","setTimeout","abort","redirect","signal","proxyUrl","fetch","catch","name","clearTimeout","status","get","header","key"],"sources":["C:/Users/ines_/bee_v2/bee_school/frontend/node_modules/link-preview-js/build/index.js"],"sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getPreviewFromContent = exports.getLinkPreview = void 0;\nvar cheerio_1 = __importDefault(require(\"cheerio\"));\nvar cross_fetch_1 = require(\"cross-fetch\");\nvar abort_controller_1 = __importDefault(require(\"abort-controller\"));\nvar url_1 = __importDefault(require(\"url\"));\nvar constants_1 = require(\"./constants\");\nfunction throwOnLoopback(address) {\n    if (constants_1.CONSTANTS.REGEX_LOOPBACK.test(address)) {\n        throw new Error(\"SSRF request detected, trying to query host\");\n    }\n}\nfunction metaTag(doc, type, attr) {\n    var nodes = doc(\"meta[\".concat(attr, \"='\").concat(type, \"']\"));\n    return nodes.length ? nodes : null;\n}\nfunction metaTagContent(doc, type, attr) {\n    return doc(\"meta[\".concat(attr, \"='\").concat(type, \"']\")).attr(\"content\");\n}\nfunction getTitle(doc) {\n    var title = metaTagContent(doc, \"og:title\", \"property\") ||\n        metaTagContent(doc, \"og:title\", \"name\");\n    if (!title) {\n        title = doc(\"title\").text();\n    }\n    return title;\n}\nfunction getSiteName(doc) {\n    var siteName = metaTagContent(doc, \"og:site_name\", \"property\") ||\n        metaTagContent(doc, \"og:site_name\", \"name\");\n    return siteName;\n}\nfunction getDescription(doc) {\n    var description = metaTagContent(doc, \"description\", \"name\") ||\n        metaTagContent(doc, \"Description\", \"name\") ||\n        metaTagContent(doc, \"og:description\", \"property\");\n    return description;\n}\nfunction getMediaType(doc) {\n    var node = metaTag(doc, \"medium\", \"name\");\n    if (node) {\n        var content = node.attr(\"content\");\n        return content === \"image\" ? \"photo\" : content;\n    }\n    return (metaTagContent(doc, \"og:type\", \"property\") ||\n        metaTagContent(doc, \"og:type\", \"name\"));\n}\nfunction getImages(doc, rootUrl, imagesPropertyType) {\n    var images = [];\n    var nodes;\n    var src;\n    var dic = {};\n    var imagePropertyType = imagesPropertyType !== null && imagesPropertyType !== void 0 ? imagesPropertyType : \"og\";\n    nodes =\n        metaTag(doc, \"\".concat(imagePropertyType, \":image\"), \"property\") ||\n            metaTag(doc, \"\".concat(imagePropertyType, \":image\"), \"name\");\n    if (nodes) {\n        nodes.each(function (_, node) {\n            if (node.type === \"tag\") {\n                src = node.attribs.content;\n                if (src) {\n                    src = url_1.default.resolve(rootUrl, src);\n                    images.push(src);\n                }\n            }\n        });\n    }\n    if (images.length <= 0 && !imagesPropertyType) {\n        src = doc(\"link[rel=image_src]\").attr(\"href\");\n        if (src) {\n            src = url_1.default.resolve(rootUrl, src);\n            images = [src];\n        }\n        else {\n            nodes = doc(\"img\");\n            if (nodes === null || nodes === void 0 ? void 0 : nodes.length) {\n                dic = {};\n                images = [];\n                nodes.each(function (_, node) {\n                    if (node.type === \"tag\")\n                        src = node.attribs.src;\n                    if (src && !dic[src]) {\n                        dic[src] = true;\n                        // width = node.attribs.width;\n                        // height = node.attribs.height;\n                        images.push(url_1.default.resolve(rootUrl, src));\n                    }\n                });\n            }\n        }\n    }\n    return images;\n}\nfunction getVideos(doc) {\n    var videos = [];\n    var nodeTypes;\n    var nodeSecureUrls;\n    var nodeType;\n    var nodeSecureUrl;\n    var video;\n    var videoType;\n    var videoSecureUrl;\n    var width;\n    var height;\n    var videoObj;\n    var index;\n    var nodes = metaTag(doc, \"og:video\", \"property\") || metaTag(doc, \"og:video\", \"name\");\n    if (nodes === null || nodes === void 0 ? void 0 : nodes.length) {\n        nodeTypes =\n            metaTag(doc, \"og:video:type\", \"property\") ||\n                metaTag(doc, \"og:video:type\", \"name\");\n        nodeSecureUrls =\n            metaTag(doc, \"og:video:secure_url\", \"property\") ||\n                metaTag(doc, \"og:video:secure_url\", \"name\");\n        width =\n            metaTagContent(doc, \"og:video:width\", \"property\") ||\n                metaTagContent(doc, \"og:video:width\", \"name\");\n        height =\n            metaTagContent(doc, \"og:video:height\", \"property\") ||\n                metaTagContent(doc, \"og:video:height\", \"name\");\n        for (index = 0; index < nodes.length; index += 1) {\n            var node = nodes[index];\n            if (node.type === \"tag\")\n                video = node.attribs.content;\n            nodeType = nodeTypes === null || nodeTypes === void 0 ? void 0 : nodeTypes[index];\n            if ((nodeType === null || nodeType === void 0 ? void 0 : nodeType.type) === \"tag\") {\n                videoType = nodeType ? nodeType.attribs.content : null;\n            }\n            nodeSecureUrl = nodeSecureUrls === null || nodeSecureUrls === void 0 ? void 0 : nodeSecureUrls[index];\n            if ((nodeSecureUrl === null || nodeSecureUrl === void 0 ? void 0 : nodeSecureUrl.type) === \"tag\") {\n                videoSecureUrl = nodeSecureUrl ? nodeSecureUrl.attribs.content : null;\n            }\n            videoObj = {\n                url: video,\n                secureUrl: videoSecureUrl,\n                type: videoType,\n                width: width,\n                height: height,\n            };\n            if (videoType && videoType.indexOf(\"video/\") === 0) {\n                videos.splice(0, 0, videoObj);\n            }\n            else {\n                videos.push(videoObj);\n            }\n        }\n    }\n    return videos;\n}\n// returns default favicon (//hostname/favicon.ico) for a url\nfunction getDefaultFavicon(rootUrl) {\n    return url_1.default.resolve(rootUrl, \"/favicon.ico\");\n}\n// returns an array of URLs to favicon images\nfunction getFavicons(doc, rootUrl) {\n    var images = [];\n    var nodes = [];\n    var src;\n    var relSelectors = [\n        \"rel=icon\",\n        \"rel=\\\"shortcut icon\\\"\",\n        \"rel=apple-touch-icon\",\n    ];\n    relSelectors.forEach(function (relSelector) {\n        // look for all icon tags\n        nodes = doc(\"link[\".concat(relSelector, \"]\"));\n        // collect all images from icon tags\n        if (nodes.length) {\n            nodes.each(function (_, node) {\n                if (node.type === \"tag\")\n                    src = node.attribs.href;\n                if (src) {\n                    src = url_1.default.resolve(rootUrl, src);\n                    images.push(src);\n                }\n            });\n        }\n    });\n    // if no icon images, use default favicon location\n    if (images.length <= 0) {\n        images.push(getDefaultFavicon(rootUrl));\n    }\n    return images;\n}\nfunction parseImageResponse(url, contentType) {\n    return {\n        url: url,\n        mediaType: \"image\",\n        contentType: contentType,\n        favicons: [getDefaultFavicon(url)],\n    };\n}\nfunction parseAudioResponse(url, contentType) {\n    return {\n        url: url,\n        mediaType: \"audio\",\n        contentType: contentType,\n        favicons: [getDefaultFavicon(url)],\n    };\n}\nfunction parseVideoResponse(url, contentType) {\n    return {\n        url: url,\n        mediaType: \"video\",\n        contentType: contentType,\n        favicons: [getDefaultFavicon(url)],\n    };\n}\nfunction parseApplicationResponse(url, contentType) {\n    return {\n        url: url,\n        mediaType: \"application\",\n        contentType: contentType,\n        favicons: [getDefaultFavicon(url)],\n    };\n}\nfunction parseTextResponse(body, url, options, contentType) {\n    if (options === void 0) { options = {}; }\n    var doc = cheerio_1.default.load(body);\n    return {\n        url: url,\n        title: getTitle(doc),\n        siteName: getSiteName(doc),\n        description: getDescription(doc),\n        mediaType: getMediaType(doc) || \"website\",\n        contentType: contentType,\n        images: getImages(doc, url, options.imagesPropertyType),\n        videos: getVideos(doc),\n        favicons: getFavicons(doc, url),\n    };\n}\nfunction parseUnknownResponse(body, url, options, contentType) {\n    if (options === void 0) { options = {}; }\n    return parseTextResponse(body, url, options, contentType);\n}\nfunction parseResponse(response, options) {\n    try {\n        var contentType = response.headers[\"content-type\"];\n        // console.warn(`original content type`, contentType);\n        if (contentType === null || contentType === void 0 ? void 0 : contentType.indexOf(\";\")) {\n            // eslint-disable-next-line prefer-destructuring\n            contentType = contentType.split(\";\")[0];\n            // console.warn(`splitting content type`, contentType);\n        }\n        if (!contentType) {\n            return parseUnknownResponse(response.data, response.url, options);\n        }\n        if (contentType instanceof Array) {\n            // eslint-disable-next-line no-param-reassign, prefer-destructuring\n            contentType = contentType[0];\n        }\n        // parse response depending on content type\n        if (constants_1.CONSTANTS.REGEX_CONTENT_TYPE_IMAGE.test(contentType)) {\n            return parseImageResponse(response.url, contentType);\n        }\n        if (constants_1.CONSTANTS.REGEX_CONTENT_TYPE_AUDIO.test(contentType)) {\n            return parseAudioResponse(response.url, contentType);\n        }\n        if (constants_1.CONSTANTS.REGEX_CONTENT_TYPE_VIDEO.test(contentType)) {\n            return parseVideoResponse(response.url, contentType);\n        }\n        if (constants_1.CONSTANTS.REGEX_CONTENT_TYPE_TEXT.test(contentType)) {\n            var htmlString_1 = response.data;\n            return parseTextResponse(htmlString_1, response.url, options, contentType);\n        }\n        if (constants_1.CONSTANTS.REGEX_CONTENT_TYPE_APPLICATION.test(contentType)) {\n            return parseApplicationResponse(response.url, contentType);\n        }\n        var htmlString = response.data;\n        return parseUnknownResponse(htmlString, response.url, options);\n    }\n    catch (e) {\n        throw new Error(\"link-preview-js could not fetch link information \".concat(e.toString()));\n    }\n}\n/**\n * Parses the text, extracts the first link it finds and does a HTTP request\n * to fetch the website content, afterwards it tries to parse the internal HTML\n * and extract the information via meta tags\n * @param text string, text to be parsed\n * @param options ILinkPreviewOptions\n */\nfunction getLinkPreview(text, options) {\n    var _a, _b, _c;\n    return __awaiter(this, void 0, void 0, function () {\n        var detectedUrl, resolvedUrl, timeout, controller, timeoutCounter, fetchOptions, fetchUrl, response, forwardedUrl, resolvedUrl, headers, normalizedResponse;\n        var _d;\n        return __generator(this, function (_e) {\n            switch (_e.label) {\n                case 0:\n                    if (!text || typeof text !== \"string\") {\n                        throw new Error(\"link-preview-js did not receive a valid url or text\");\n                    }\n                    detectedUrl = text\n                        .replace(/\\n/g, \" \")\n                        .split(\" \")\n                        .find(function (token) { return constants_1.CONSTANTS.REGEX_VALID_URL.test(token); });\n                    if (!detectedUrl) {\n                        throw new Error(\"link-preview-js did not receive a valid a url or text\");\n                    }\n                    if ((options === null || options === void 0 ? void 0 : options.followRedirects) === \"manual\" && !(options === null || options === void 0 ? void 0 : options.handleRedirects)) {\n                        throw new Error(\"link-preview-js followRedirects is set to manual, but no handleRedirects function was provided\");\n                    }\n                    if (!!!(options === null || options === void 0 ? void 0 : options.resolveDNSHost)) return [3 /*break*/, 2];\n                    return [4 /*yield*/, options.resolveDNSHost(detectedUrl)];\n                case 1:\n                    resolvedUrl = _e.sent();\n                    throwOnLoopback(resolvedUrl);\n                    _e.label = 2;\n                case 2:\n                    timeout = (_a = options === null || options === void 0 ? void 0 : options.timeout) !== null && _a !== void 0 ? _a : 3000;\n                    controller = new abort_controller_1.default();\n                    timeoutCounter = setTimeout(function () { return controller.abort(); }, timeout);\n                    fetchOptions = {\n                        headers: (_b = options === null || options === void 0 ? void 0 : options.headers) !== null && _b !== void 0 ? _b : {},\n                        redirect: (_c = options === null || options === void 0 ? void 0 : options.followRedirects) !== null && _c !== void 0 ? _c : \"error\",\n                        signal: controller.signal,\n                    };\n                    fetchUrl = (options === null || options === void 0 ? void 0 : options.proxyUrl)\n                        ? options.proxyUrl.concat(detectedUrl)\n                        : detectedUrl;\n                    return [4 /*yield*/, (0, cross_fetch_1.fetch)(fetchUrl, fetchOptions).catch(function (e) {\n                            if (e.name === \"AbortError\") {\n                                throw new Error(\"Request timeout\");\n                            }\n                            clearTimeout(timeoutCounter);\n                            throw e;\n                        })];\n                case 3:\n                    response = _e.sent();\n                    if (!(response.status > 300 &&\n                        response.status < 309 &&\n                        fetchOptions.redirect === \"manual\" &&\n                        (options === null || options === void 0 ? void 0 : options.handleRedirects))) return [3 /*break*/, 7];\n                    forwardedUrl = response.headers.get(\"location\") || \"\";\n                    if (!options.handleRedirects(fetchUrl, forwardedUrl)) {\n                        throw new Error(\"link-preview-js could not handle redirect\");\n                    }\n                    if (!!!(options === null || options === void 0 ? void 0 : options.resolveDNSHost)) return [3 /*break*/, 5];\n                    return [4 /*yield*/, options.resolveDNSHost(forwardedUrl)];\n                case 4:\n                    resolvedUrl = _e.sent();\n                    throwOnLoopback(resolvedUrl);\n                    _e.label = 5;\n                case 5: return [4 /*yield*/, (0, cross_fetch_1.fetch)(forwardedUrl, fetchOptions)];\n                case 6:\n                    response = _e.sent();\n                    _e.label = 7;\n                case 7:\n                    clearTimeout(timeoutCounter);\n                    headers = {};\n                    response.headers.forEach(function (header, key) {\n                        headers[key] = header;\n                    });\n                    _d = {\n                        url: (options === null || options === void 0 ? void 0 : options.proxyUrl)\n                            ? response.url.replace(options.proxyUrl, \"\")\n                            : response.url,\n                        headers: headers\n                    };\n                    return [4 /*yield*/, response.text()];\n                case 8:\n                    normalizedResponse = (_d.data = _e.sent(),\n                        _d);\n                    return [2 /*return*/, parseResponse(normalizedResponse, options)];\n            }\n        });\n    });\n}\nexports.getLinkPreview = getLinkPreview;\n/**\n * Skip the library fetching the website for you, instead pass a response object\n * from whatever source you get and use the internal parsing of the HTML to return\n * the necessary information\n * @param response Preview Response\n * @param options IPreviewLinkOptions\n */\nfunction getPreviewFromContent(response, options) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            if (!response || typeof response !== \"object\") {\n                throw new Error(\"link-preview-js did not receive a valid response object\");\n            }\n            if (!response.url) {\n                throw new Error(\"link-preview-js did not receive a valid response object\");\n            }\n            return [2 /*return*/, parseResponse(response, options)];\n        });\n    });\n}\nexports.getPreviewFromContent = getPreviewFromContent;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}